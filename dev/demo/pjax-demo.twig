{% extends "base.twig" %}

{% block content %}

<div class="uk-container" data-template="test.twig">
  
  {% include 'breads.twig' %}
  
  <div id="ToolbarNav" class="uk-section uk-section-small" data-template="shop-toolbar.twig">
    
    <div class="desktop-toolbar uk-visible@s">
      <nav id="ShopToolbar" class="uk-navbar-container uk-navbar-transparent" uk-navbar>
        <div id="ShopToolbarLeft" class="uk-navbar-left pull-left-15">
          <div id="ShopArchiveTitle" class="uk-navbar-item min-height-40">
            <h1 class="woocommerce-products-header__title page-title uk-margin-remove-bottom font-2">Test</h1>
          </div>
        </div>
        <div id="ShopToolbarRight" class="uk-navbar-right pull-right-15">
          <div id="SortByDrop" class="uk-navbar-item min-height-40">
            <span class="uk-margin-small-right">Sort by:</span>
          </div>
          <div id="GridList" class="uk-navbar-item min-height-40">
            <a href="#" class="grid-toggle uk-button uk-button-default uk-button-small padding-0-10 uk-margin-small-right"><span uk-icon="grid"></span></a>
            <a href="#" class="list-toggle uk-button uk-button-default uk-button-small padding-0-10"><span uk-icon="icon: list"></span></a>
          </div>
          <div id="FilterButton" class="uk-navbar-item min-height-40">
            <a class="uk-button uk-button-default uk-button-small" href="#" uk-toggle>
              <i class="fas fa-bars uk-margin-small-right"></i>
              <span class="uk-text-capitalize font-400">Filter</span>
            </a>
          </div>
        </div>
      </nav>
    </div>
    
    <div class="mobile-toolbar uk-hidden@s">
      <h1 class="woocommerce-products-header__title page-title font-1.5">Shop</h1>
      <nav class="uk-navbar-container uk-navbar-transparent" uk-navbar>
        <div class="uk-navbar-left pull-left-15">
          <div class="uk-navbar-item min-height-40">
            Sort by:
          </div>
        </div>
        <div class="uk-navbar-right pull-right-15">
          <div class="uk-navbar-item min-height-40">
            <a class="uk-button uk-button-default uk-button-small" href="#" uk-toggle>Filter</a>
          </div>
        </div>
      </nav>
    </div>
    
  </div>
  
  <a id="target" class="uk-button uk-button-primary uk-margin-bottom" data="/shop/?orderby=price-desc&product_cat=groceries&grid_list=grid-view&s=a" data-pjax>Click</a>
    
  <div id="ajax-filters-wrap">
    <div class="uk-margin-large-bottom">Content</div>
  </div>
  
</div>

{% endblock  %}

{% block spec_scripts %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js" integrity="sha512-7G7ueVi8m7Ldo2APeWMCoGjs4EjXDhJ20DrPglDQqy8fnxsFQZeJNtuQlTT0xoBQJzWRFp4+ikyMdzDOcW36kQ==" crossorigin="anonymous"></script>

<script>

  // using pjax jquery plugin https://github.com/defunkt/jquery-pjax
  jQuery(document).ready( function($) {
    
    $.pjax.defaults.timeout = 10000,
    
    $('a[data-pjax]').click(function(event) {
      $.pjax.defaults.timeout = 10000,
      ajax_url = $(this).attr('data');
        $.pjax({
            url: ajax_url,
            container: '#ajax-filters-wrap',
            fragment: '#MainProductArchive'
        });
    
        return false;
    });
    
  });

  // using jquery.load (which uses jquery.get
  // jQuery(document).ready( function($) {
  // 
  //   $("#target").click(function(e){
  // 
  //     e.preventDefault();
  // 
  //     ajax_url = $(this).attr('href');
  // 
  //     var loader = '<div id="ajax_loader" class="loader-ajax uk-height-medium"></div>';
  // 
  //     $('#ajax-filters-wrap').append(loader);
  // 
  //     $("#ajax-filters-wrap").load(ajax_url + ' #MainProductArchive', function() {
  // 
  //       window.history.pushState( 'Details', 'Filtered', ajax_url);
  // 
  //       window.history.pushState({
  //           "pageTitle": response.pageTitle
  //       }, "", ajax_url);
  // 
  //       var infScroll = new InfiniteScroll( '.archive-posts', {
  //         path: '.next',
  //         append: '.item',
  //         status: '.page-load-status',
  //         hideNav: '.pagi',
  //         history: false,
  //       });
  // 
  //     });
  // 
  //   });
  // });

  // using plain jqeury.get
  // jQuery(document).ready( function($) {
  // 
  //   // on click of a filter link
  //   $( '#target' ).click(function(e) {
  // 
  //     // prevent default link behaviour
  //     e.preventDefault();
  // 
  //     // define the ajax_url as the url from the clicked link
  //     ajax_url = $(this).attr('href');
  // 
  //     // define the loader html
  //     loader = '<div id="ajax_loader" class="loader-ajax uk-height-medium"></div>';
  // 
  //     // define the domain/host as the state object for pushState
  //     state = location.protocol + "//" + location.host,
  //     // define the title as title object for pushState
  //     title = '',
  // 
  //     // ajax request using GET with request url gotten from clicked link
  //     $.ajax({
  //       url: ajax_url,
  //       type : 'get',
  //       beforeSend: function () {
  //         // before send, show the loader
  //         $('#ajax-filters-wrap').html(loader);
  //       },
  //       success: function(response) {
  // 
  //         // on success of request, insert #MainProductArchive from response into #ajax-fiters
  //         $('#ajax-filters-wrap').html($(response).find('#MainProductArchive'));
  // 
  //         window.history.pushState(domain, title, ajax_url)
  // 
  //         var infScroll = new InfiniteScroll( '.archive-posts', {
  //           path: '.next',
  //           append: '.item',
  //           status: '.page-load-status',
  //           hideNav: '.pagi',
  //           history: false,
  //         });
  // 
  //       },
  //     })
  // 
  //   });
  //   // ajax_url = "https://organicforhealth.ie/shop/?orderby=price-desc&product_cat=groceries&grid_list=grid-view&s=a";
  // })
  
</script>

{% endblock %}